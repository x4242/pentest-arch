#!/usr/bin/env bash

# Description:
# ------------
# Basic config and installation of newly installed Arch.
#
# lastmod: 2019-07-28T18:13:32+02:00
# Change History:
# ---------------
# - 2019-07-28: moved intial parts to new script and renemaed to basic
# - 2019-07-26:
#   - added macchanger
#   - added random hostname part
# - 2019-07-25: added grc + placeholder for random hostname script
# - 2019-07-23:
#   - added diffrent package groups
#   - added mirrorlist ranking
# - 2019-07-22: created

# String definitions for colored printf output
# [ ERROR ] in light red
# [ INFO  ] in light green
# [ INPUT ] in light yellow
STR_ERROR="[ \e[91mERROR\e[0m ]"
STR_INFO="[ \e[92mINFO\e[0m  ]"
STR_INPUT="[ \e[93mINPUT\e[0m ]"

##########################################
# Check if root / sudo
##########################################
if [ "$EUID" -eq 0 ]; then
  printf "%b Do not run with sudo / as root.\n" "${STR_ERROR}" >&2
  exit 1
fi

##########################################
# Install yay from AUR
##########################################
printf "%b Installing yay...\n" "${STR_INFO}"
git clone https://aur.archlinux.org/yay.git /tmp/yay
if cd /tmp/yay; then
  makepkg -si
else
  printf "%b Could not cd into /tmp/yay.\n" "${STR_ERROR}" >&2
  exit 1
fi
rm -rf /tmp/yay
printf "%b Done installing yay.\n" "${STR_INFO}"

##########################################
# Desktop environment
##########################################
pacman_desktop_pkgs=(
                    firefox
                    lightdm
                    lightdm-gtk-greeter
                    mousepad
                    noto-fonts
                    papirus-icon-theme
                    ristretto
                    thunar-archive-plugin
                    ttf-bitstream-vera
                    ttf-croscore
                    ttf-dejavu
                    ttf-droid
                    ttf-liberation
                    ttf-roboto
                    xfce4
                    xfce4-datetime-plugin
                    xfce4-mount-plugin
                    xfce4-whiskermenu-plugin
                    xorg
                    xorg-fonts
                    )

sudo localectl set-x11-keymap de-latin1-nodeadkeys
sudo systemctl enable lightdm.service

for package in ${pacman_desktop_pkgs[*]}; do
  pacman -S --needed --noconfirm ${package}
done

aur_desktop_pkgs=(
                  ttf-ms-win10
                  ttf-courier-prime
                  )

for package in ${aur_desktop_pkgs[*]}; do
  yay -S --noconfirm ${package}
done

exit 0
